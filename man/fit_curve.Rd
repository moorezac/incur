% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{fit_curve}
\alias{fit_curve}
\title{Fit a Curve to Data}
\usage{
fit_curve(
  data,
  x_var,
  y_var,
  curve_opts = NA,
  shared_opts = NA,
  outlier_opts = NA
)
}
\arguments{
\item{data}{A data frame containing the variables to fit.}

\item{x_var}{Character string specifying the column name for the independent
variable (typically time).}

\item{y_var}{Character string specifying the column name for the dependent
variable (e.g., cell count, confluence, or a calculated metric).}

\item{curve_opts}{A named list of curve fitting options. Elements include:
\itemize{
\item \code{model}: Character string specifying a built-in model from \code{incur_models} or "loess".
\item \code{model_func}: A function that describes a curve in terms of x (used if \code{model} is NA).
\item \code{start_func}: A function that generates a named list of starting values for \code{model_func} (used if \code{model} is NA).
\item \code{start_values}: A named list of starting values for \code{model_func}.
\item \code{lower_bounds}: A named list that specifies the lower bounds for parameters in \code{model_func}.
\item \code{upper_bounds}:A named list that specifies the upper bounds for parameters in \code{model_func}.
}}

\item{shared_opts}{A named list of shared parameter options. Elements include:
\itemize{
\item \code{share_group}: Character string specifying the column name for the grouping variable (default: NA).
\item \code{share_params}: Character string specifying which parameters in the model are to be shared (default: NA).
\item \code{return_func}: Logical; return fitted function? (default: FALSE).
}}

\item{outlier_opts}{A named list of shared parameter options. Elements include:
\itemize{
\item \code{huber}: Logical; use Huber robust regression? (default: FALSE).
\item \code{huber_iter}: Maximum iterations for Huber (default: 100).
\item \code{huber_k}: Huber tuning constant (default: 1.345).
\item \code{huber_tol}: Convergence tolerance for Huber (default: 1e-6).
\item \code{rout}: Logical; use ROUT outlier detection? (default: FALSE).
\item \code{rout_q}: False discovery rate for ROUT (default: 1e-3).
\item \code{rout_scale}: Scale estimator for ROUT, either "mad" or "quantile" (default: "mad").
}}
}
\value{
A list containing:
\itemize{
\item \code{data}: The prepared data frame, with an \code{outlier_<y_var>} column added if ROUT detection was used.
\item \verb{fit:} A named list with the fitted object \code{obj}, in addition to \code{warnings} and \code{errors} that occured during the fit.
\item \code{func}: The model function (only if \code{shared_opts$return_func = TRUE}).
}
}
\description{
Fits a non-linear model to x-y data with support for built-in models,
custom model functions, shared parameters across groups, and robust
outlier handling via Huber regression and/or ROUT detection.
}
\examples{
\dontrun{
# Fit a built-in model
result <- fit_curve(
  data = my_data,
  x_var = "time",
  y_var = "response",
  curve_opts = list(model = "exponential")
)
# Fit with ROUT outlier detection
result <- fit_curve(
  data = my_data,
  x_var = "time",
  y_var = "response",
  curve_opts = list(model = "logistic"),
  outlier_opts = list(rout = TRUE, rout_q = 0.01)
)
}
}
