% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/interpolate.R
\name{interpolate_curve_concentration}
\alias{interpolate_curve_concentration}
\title{Fit and Select Best Models Across Concentrations}
\usage{
interpolate_curve_concentration(
  data,
  x_var,
  y_var,
  treatment_column,
  concentration_column,
  negative_control_name,
  positive_control_name = NA,
  loess = FALSE,
  loess_span = 0.3,
  outlier_opts = NA,
  models = names(incur_models)
)
}
\arguments{
\item{data}{A data frame containing time-course measurements.}

\item{x_var}{Character string specifying the column name for the independent
variable (typically time).}

\item{y_var}{Character string specifying the column name for the dependent
variable (e.g., cell count, confluence, or a calculated metric).}

\item{treatment_column}{Character string specifying the column containing
treatment identifiers.}

\item{concentration_column}{Character string specifying the column containing
drug concentrations in log10 molar format.}

\item{negative_control_name}{Character string identifying the negative
control (e.g., "DMSO" or "Vehicle") in \code{treatment_column}.}

\item{positive_control_name}{Character string identifying the positive
control (e.g., a cytotoxic agent) in \code{treatment_column}. If provided,
NDR values are calculated. Default is NULL.}

\item{loess}{Logical; if TRUE, fits LOESS curves instead of parametric models.
Default is FALSE.}

\item{loess_span}{TODO: description.}

\item{outlier_opts}{A named list of shared parameter options. Elements include:
\itemize{
\item \code{huber}: Logical; use Huber robust regression? (default: FALSE).
\item \code{huber_iter}: Maximum iterations for Huber (default: 100).
\item \code{huber_k}: Huber tuning constant (default: 1.345).
\item \code{huber_tol}: Convergence tolerance for Huber (default: 1e-6).
\item \code{rout}: Logical; use ROUT outlier detection? (default: FALSE).
\item \code{rout_q}: False discovery rate for ROUT (default: 1e-3).
\item \code{rout_scale}: Scale estimator for ROUT, either "mad" or "quantile" (default: "mad").
}}

\item{models}{Character vector of model names from \code{incur_models}.}

\item{loses_span}{Span to use for LOESS.}
}
\value{
A list containing:
\itemize{
\item\code{model_list}: A named list (one element per treatment-concentration
combination) where each element contains:
\itemize
\item \code{selected}: The best-fitting model object (or NA if excluded).
\item \code{data}: The subset of data for that combination.
}
}
\item1: A \code{ggplot2} object showing all fitted models for each
concentration, with the selected model highlighted.
}
}
\description{
Fits multiple growth models to time-course data for each treatment-concentration
combination, selects the best model by BIC, and generates a diagnostic plot
comparing all fitted models.
}
\note{
Only a single treatment compound (plus controls) should be present in
the data. The function will error if multiple non-control treatments are
detected.
}
\seealso{
\code{\link{fit_curve}}, \code{\link{calc_inhibition_metrics}},
\code{\link{predict_data}}
}
