% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{plot_lgr_score}
\alias{plot_lgr_score}
\title{Plot Longitudinal Growth Rate Score with Dose-Response Curve}
\usage{
plot_lgr_score(
  model_list,
  x_var,
  metric = "gr",
  treatment_column,
  negative_control_name,
  positive_control_name = NA,
  concentration_column,
  curve_opts = list(model = "five_param_sigmoid_log", lower_bounds = list(bottom = 0),
    upper_bounds = list(top = 100))
)
}
\arguments{
\item{model_list}{A named list of model results, typically output from
\code{\link{interpolate_curve_concentration}}. Each element should contain
\code{selected} (the fitted model) and \code{data} (the subset of data).}

\item{x_var}{Character string specifying the column name for the independent
variable (typically time).}

\item{metric}{Character string specifying the response metric to use,
either \code{"gr"} for growth rate inhibition or \code{"ndr"} for
normalised drug response. Default is \code{"gr"}.}

\item{treatment_column}{Character string specifying the column containing
treatment identifiers.}

\item{negative_control_name}{Character string identifying the negative
control (e.g., "DMSO" or "Vehicle") in \code{treatment_column}.}

\item{positive_control_name}{Character string identifying the positive
control (e.g., a cytotoxic agent) in \code{treatment_column}. If provided,
NDR values are calculated. Default is NULL.}

\item{concentration_column}{Character string specifying the column containing
drug concentrations in log10 molar format.}

\item{curve_opts}{A named list of curve fitting options. Elements include:
\itemize{
\item \code{model}: Character string specifying a built-in model from \code{incur_models} or "loess".
\item \code{model_func}: A function that describes a curve in terms of x (used if \code{model} is NA).
\item \code{start_func}: A function that generates a named list of starting values for \code{model_func} (used if \code{model} is NA).
\item \code{start_values}: A named list of starting values for \code{model_func}.
\item \code{lower_bounds}: A named list that specifies the lower bounds for parameters in \code{model_func}.
\item \code{upper_bounds}:A named list that specifies the upper bounds for parameters in \code{model_func}.
}}

\item{lower_bounds}{TODO: description.}
}
\value{
A \code{ggplot2} object displaying:
\itemize{
\item Points showing normalised AOC values at each concentration
\item Fitted dose-response curve
\item Title with LGR score and adjusted LGR score (LGR × R²)
}
The x-axis is formatted for log-molar concentrations.
}
\description{
Calculates and visualises the Longitudinal Growth Rate (LGR) score
from time-course drug response data. Fits a dose-response curve to
normalised area-over-curve values and reports both raw and
goodness-of-fit-adjusted LGR scores.
}
\details{
Higher LGR scores indicate greater overall drug efficacy. The adjusted
score penalises poor model fits.
}
\examples{
\dontrun{
# Calculate and plot LGR score
lgr_plot <- plot_lgr_score(
  model_list = fitted_models$model_list,
  x_var = "time",
  metric = "gr",
  treatment_column = "treatment",
  negative_control_name = "DMSO",
  positive_control_name = NA,
  concentration_column = "dose_uM"
)
# With custom dose-response model
lgr_plot <- plot_lgr_score(
  model_list = fitted_models$model_list,
  x_var = "time",
  metric = "gr",
  treatment_column = "treatment",
  negative_control_name = "DMSO",
  positive_control_name = "Staurosporine",
  concentration_column = "dose_uM",
  curve_opts = list(model = "four_param_sigmoid_log")
)
}
}
\seealso{
\code{\link{calc_inhibition_metrics}}, \code{\link{fit_curve}},
\code{\link{interpolate_curve_concentration}}, \code{\link{theme_incur}}
}
