% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metrics.R
\name{calc_inhibition_metrics}
\alias{calc_inhibition_metrics}
\title{Calculate Growth Rate Inhibition Metrics}
\usage{
calc_inhibition_metrics(
  data = NA,
  model_list = NA,
  x_var,
  y_var,
  treatment_column,
  concentration_column,
  negative_control_name,
  positive_control_name = NA,
  cap = TRUE,
  return_all_columns = FALSE
)
}
\arguments{
\item{data}{A data frame containing time-course measurements. Required if
\code{model_list} is NULL.}

\item{model_list}{A named list of model results, typically output from
\code{\link{interpolate_curve_concentration}}. Each element should contain
\code{selected} (the fitted model) and \code{data} (the subset of data).}

\item{x_var}{Character string specifying the column name for the independent
variable (typically time).}

\item{y_var}{Character string specifying the column name for the dependent
variable (e.g., cell count, confluence, or a calculated metric).}

\item{treatment_column}{Character string specifying the column containing
treatment identifiers.}

\item{concentration_column}{Character string specifying the column containing
drug concentrations in log10 molar format.}

\item{negative_control_name}{Character string identifying the negative
control (e.g., "DMSO" or "Vehicle") in \code{treatment_column}.}

\item{positive_control_name}{Character string identifying the positive
control (e.g., a cytotoxic agent) in \code{treatment_column}. If provided,
NDR values are calculated. Default is NULL.}

\item{cap}{Logical; if TRUE (default), GR and NDR values are capped at 1.}

\item{return_all_columns}{Logical; if TRUE, returns all intermediate columns
used in calculations. If FALSE (default), returns only original columns
plus \code{gr} (and \code{ndr} if applicable).}
}
\value{
A data frame containing the original data plus:
\itemize{
\item \code{gr}: Growth rate inhibition values, ranging from -1 (complete cell
death) through 0 (cytostasis) to 1 (no effect).
\item \code{ndr}: Normalised drug response values (only if
\code{positive_control_name} is provided), ranging from -1 to 1.
}
If \code{return_all_columns = TRUE}, additional columns include:
\code{time_zero_values}, \code{negative_control_zero}, \code{normalised},
\code{negative_control_norm}, and (if applicable) \code{positive_control_zero}
and \code{positive_control_norm}.
}
\description{
Computes GR (growth rate inhibition) values and optional NDR (normalised
drug response) values from time-course data. Supports input as either raw
data or pre-fitted model objects.
}
\details{
GR values are calculated using the formula from Hafner et al. (2016):
\deqn{GR = 2^{log_2(x(c)/x_0) / log_2(x_{ctrl}/x_0)} - 1}
where \eqn{x(c)} is the measured value at concentration \eqn{c}, \eqn{x_0}
is the value at time zero, and \eqn{x_{ctrl}} is the negative control value.
NDR values provide an additional normalisation against a positive control,
useful when a maximal effect reference is available.
Groups marked with \code{exclude = TRUE} in the input data will have their
GR and NDR values set to -1.
}
\references{
Hafner, M., Niepel, M., Chung, M., & Sorger, P. K. (2016). Growth rate
inhibition metrics correct for confounders in measuring sensitivity to
cancer drugs. \emph{Nature Methods}, 13(6), 521-527.
}
