% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{plot_curve_concentration_metric_dose}
\alias{plot_curve_concentration_metric_dose}
\title{Plot Dose-Response Curve for Growth Rate Metric}
\usage{
plot_curve_concentration_metric_dose(
  model_list,
  x_var,
  metric = "gr",
  concentration_column,
  treatment_column,
  negative_control_name,
  positive_control_name = NA,
  curve_opts = list(model = "five_param_sigmoid_log", lower_bounds = list(bottom = -1),
    upper_bounds = list(top = 1)),
  start_colour = "#0085ca"
)
}
\arguments{
\item{model_list}{A named list of model results, typically output from
\code{\link{interpolate_curve_concentration}}. Each element should contain
\code{selected} (the fitted model) and \code{data} (the subset of data).}

\item{x_var}{Character string specifying the column name for the independent
variable (typically time).}

\item{metric}{Character string specifying the response metric to use,
either \code{"gr"} for growth rate inhibition or \code{"ndr"} for
normalised drug response. Default is \code{"gr"}.}

\item{concentration_column}{Character string specifying the column containing
drug concentrations in log10 molar format.}

\item{treatment_column}{Character string specifying the column containing
treatment identifiers.}

\item{negative_control_name}{Character string identifying the negative
control (e.g., "DMSO" or "Vehicle") in \code{treatment_column}.}

\item{positive_control_name}{Character string identifying the positive
control (e.g., a cytotoxic agent) in \code{treatment_column}. If provided,
NDR values are calculated. Default is NULL.}

\item{curve_opts}{A named list of curve fitting options. Elements include:
\itemize{
\item \code{model}: Character string specifying a built-in model from \code{incur_models} or "loess".
\item \code{model_func}: A function that describes a curve in terms of x (used if \code{model} is NA).
\item \code{start_func}: A function that generates a named list of starting values for \code{model_func} (used if \code{model} is NA).
\item \code{start_values}: A named list of starting values for \code{model_func}.
\item \code{lower_bounds}: A named list that specifies the lower bounds for parameters in \code{model_func}.
\item \code{upper_bounds}:A named list that specifies the upper bounds for parameters in \code{model_func}.
}}

\item{lower_bounds}{TODO: description.}
}
\value{
A list containing:
\describe{
\item{data}{The processed data frame with calculated metrics}
\item{plot}{A \code{ggplot2} object showing points coloured by timepoint,
fitted dose-response curve, vertical line at IC50/GR50 (if calculable),
and dashed horizontal line at y = 0 (cytostasis). The x-axis is
formatted for log-molar concentrations.}
}
}
\description{
Fits and visualises a dose-response curve showing the relationship between
drug concentration and growth rate inhibition metric, with time indicated
by point colour.
}
\examples{
\dontrun{
result <- plot_curve_concentration_metric_dose(
  model_list = fitted_models$model_list,
  x_var = "time",
  metric = "gr",
  concentration_column = "dose_uM",
  treatment_column = "treatment",
  negative_control_name = "DMSO"
)
result$plot
}
}
\seealso{
\code{\link{calc_inhibition_metrics}}, \code{\link{fit_curve}},
\code{\link{theme_incur}}
}
