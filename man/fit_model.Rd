% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_core.R
\name{fit_model}
\alias{fit_model}
\title{Fit Mathematical Models to Biological Data}
\usage{
fit_model(
  data,
  x_var,
  y_var,
  model = NULL,
  model_func = NULL,
  start_func = NULL,
  start_values = NULL,
  huber = FALSE,
  huber_opts = NULL,
  rout = FALSE,
  rout_opts = NULL,
  share_group = NULL,
  share_params = NULL,
  lower_bounds = NULL,
  upper_bounds = NULL,
  return_func = FALSE
)
}
\arguments{
\item{data}{A data frame or tibble containing the experimental data.}

\item{x_var}{Character string specifying the independent variable column name.}

\item{y_var}{Character string specifying the dependent variable column name.}

\item{model}{Character string specifying a built-in model name from \code{incur_models}.}

\item{model_func}{Optional custom function defining the mathematical model.}

\item{start_func}{Optional function to generate starting parameter values.}

\item{start_values}{Optional named list of starting parameter values.}

\item{huber}{Logical indicating whether to apply Huber robust regression (default: FALSE).}

\item{huber_opts}{List of Huber regression options (iter_max, k, tol).}

\item{rout}{Logical indicating whether to apply ROUT outlier detection (default: FALSE).}

\item{rout_opts}{List of ROUT options (q, scale_method).}

\item{share_group}{Character string specifying grouping variable for shared parameters.}

\item{share_params}{Character vector of parameter names to share across groups.}

\item{lower_bounds}{Named list of lower parameter bounds.}

\item{upper_bounds}{Named list of upper parameter bounds.}

\item{return_func}{Logical indicating whether to return the model function (default: FALSE).}
}
\value{
A list containing:
\describe{
\item{fit}{Fitted nls model object}
\item{data}{Processed data with any outlier flags}
\item{func}{Model function (if return_func = TRUE)}
}
}
\description{
Comprehensive function for fitting nonlinear mathematical models to biological
data with support for built-in models, custom functions, robust regression,
outlier detection, and shared parameters across groups.
}
\details{
This function provides a comprehensive interface for fitting mathematical models
to biological data. It supports:
\itemize{
\item Built-in models via the \code{model} parameter
\item Custom models via \code{model_func} and \code{start_func}
\item Robust regression to reduce outlier influence
\item Automatic outlier detection and removal
\item Shared parameters across experimental groups
\item Parameter bounds for constrained optimization
}
}
\examples{
\dontrun{
# Fit exponential growth model to cell growth data
result <- fit_model(
  data = growth_data,
  x_var = "time_hours",
  y_var = "cell_count",
  model = "exponential_growth"
)

# Fit dose-response curve with outlier detection
result <- fit_model(
  data = dose_response,
  x_var = "concentration",
  y_var = "viability",
  model = "four_param_sigmoid_log",
  rout = TRUE
)

# Fit with shared parameters across cell lines
result <- fit_model(
  data = multi_line_data,
  x_var = "time",
  y_var = "growth",
  model = "logistic_growth",
  share_group = "cell_line",
  share_params = c("k")  # Share growth rate parameter
)
}
}
\seealso{
Other model_fitting: 
\code{\link{execute_fit}()},
\code{\link{fit_model_conc}()},
\code{\link{try_fit}()}
}
\concept{model_fitting}
