% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/outlier.R
\name{huber_irwls}
\alias{huber_irwls}
\title{Huber IRWLS}
\usage{
huber_irwls(obj, args, data, model_func, k = 1.345, outlier_opts = NULL)
}
\arguments{
\item{obj}{A fitted \code{nls} object from \code{fit_curve()} or similar.}

\item{args}{A named list of arguments to pass to \code{minpack.lm::nlsLM()}.}

\item{data}{Data frame containing the fitting data.}

\item{model_func}{A function that describes a curve in terms of \code{x}
and individual curve parameters.}

\item{k}{TODO: description.}

\item{outlier_opts}{A named list of shared parameter options. Elements include:
\itemize{
\item \code{huber}: Logical; use Huber robust regression? (default: FALSE).
\item \code{huber_iter}: Maximum iterations for Huber (default: 100).
\item \code{huber_k}: Huber tuning constant (default: 1.345).
\item \code{huber_tol}: Convergence tolerance for Huber (default: 1e-6).
\item \code{rout}: Logical; use ROUT outlier detection? (default: FALSE).
\item \code{rout_q}: False discovery rate for ROUT (default: 1e-3).
\item \code{rout_scale}: Scale estimator for ROUT, either "mad" or "quantile" (default: "mad").
}}
}
\value{
Updated nls fit object with robust parameter estimates.
}
\description{
Apply Iteratively Re-weighted Least Squares with a Huber loss to reduce
the influence of outliers on model fits.
}
\details{
This implementation is faster than performing a new fit at each iteration.
}
\keyword{internal}
